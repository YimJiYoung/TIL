# 네트워크 계층

## IP

네트워크 상의 어떤 호스트로부터 다른 호스트로 데이터를 전송하는 역할을 한다.
출발지와 목적지의 네트워크는 같거나 다를 수 있고, 목적지가 다른 네트워크에 있을 때는 경로 상의 라우터가 IP 패킷을 라우팅한다.

### 헤더

<img width="412" alt="image" src="https://blog.kakaocdn.net/dn/dPyASZ/btq0A3Dj5V1/WyKt2YY8uLo72rtk1JPlB1/img.png">


### IP 주소

호스트를 식별하기 위한 식별 정보이며 이더넷 등의 인터페이스에 대해 설정된다. IP 주소는 32비트이며 8비트씩 0 ~ 255 사이의 10진수로 변환하는 도트형 10진 표기를 사용한다.

#### IP 주소 구성

IP 주소는 네트워크를 식별하는 네트워크부와 네트워크 내 호스트(의 인터페이스)를 식별하는 호스트부로 구성된다.
네트워크부와 호스트부의 범위는 가변적이다. IP 주소의 어디까지가 네트워크부인지 명시하는 것이 서브넷 마스크이다.

- 호스트부를 모두 비트 '0'으로 채우면 네트워크 자체를 식별하기 위한 네트워크 주소가 된다.
- 호스트부를 모두 비트 '1'로 채우면 브로드캐스트(같은 네트워크에 있는 모든 호스트에 일괄적으로 전송) 주소가 된다.

#### 공인/사설 IP 주소

호스트의 인터페이스에 IP 주소를 설정해야 IP 프로토콜을 통해 네트워크 통신을 할 수 있다.
IP 주소는 이용 범위에 따라 공인 IP 주소와 사설 IP 주소로 나뉜다. 공인(퍼블릭) 주소는 인터넷에서 이용하는 IP이다. 공인 주소는 중복되지 않도록 관리되며 일반적으로 인터넷 접속 서비스와 계약 시 공인 주소가 할당됩니다. 사설 주소는 사설 네트워크에서 이용하는 IP이며 주소 범위는 다음과 같다.
- 10.0.0.0 ~ 10.255.255.255
- 172.16.0.0 ~ 171.31.255.255
- 192.168.0.0 ~ 192.168.225.255

사설 네트워크에서 인터넷으로 통신하려면 사설 주소를 그대로 이용하여 통신할 수 없기 때문에 공인 주소로 변환해주는 NAT(Network Address Translation)가 필요하다.
그러나 사설 주소와 공인 주소를 1대1로 대응시키려면, 공인 주소가 많이 필요해지므로 복수의 사설 주소를 하나의 글로벌 주소에 대응시키는 주소 변환 NAPT(Network Address Port Translation)이 있다.

### ARP

이더넷 인터페이스에서 IP 패킷을 내보낼 때는 이더넷 헤더로 캡슐화하는데 이때 목적지 MAC 주소를 지정해야 한다. 목적지 IP 주소에 대응하는 MAC 주소를 구하기 위해 ARP를 사용한다.
